extends ../../layouts/default.pug
include ../../mixins/filter-status.pug
include ../../mixins/search.pug
include ../../mixins/pagination.pug
include ../../mixins/form-change-multi.pug
include ../../mixins/alert.pug
include ../../mixins/sort.pug
include ../../mixins/table-tree.pug
block main 
  +alert-success("5000")
  h1 Danh sách tài khoản

  .card.mb-3
    .card-header Bộ lọc và tìm kiếm
    .card-body
      .row 
        .col-6
          //- +filter-status(filterStatus)
        .col-6 
          //- +search(keyword)
 
  .card.mb-3
    .card-header Danh sách
      .card-body
        .row 
          .col-8
            //- +form-change-multi(`${prefixAdmin}/product-category/change-multi?_method=PATCH`)
          .col-4
            a(
              href=`${prefixAdmin}/accounts/create`
              class="btn btn-outline-success mb-2"
            ) + Tạo tài khoản
          table(
            class="table table-hover table-sm"
          )
            thead 
              tr 
                th STT
                th Ảnh đại diện 
                th Tên tài khoản 
                th Chức vụ
                th Trạng thái
                th Hành động
            tbody
              each item, index in accounts 
                tr 
                  td #{index + 1}
                  td 
                    img(
                      src= item.avatar,
                      alt = item.title,
                      width="100px",
                      height="auto"
                    )
                  td #{item.fullName}
                  td #{item.role.title}
                  td
                    if(item.status == "active")
                      a(
                        href="javascript:;" 
                        class="badge badge-success"
                        data-status=item.status
                        data-id=item.id
                        button-change-status=role.permissions.includes("accounts_edit") ? "" : null
                        disable=role.permissions.includes("accounts_edit") ? null : ""
                        style=role.permissions.includes("accounts_edit") ? "" : "pointer-events: none; opacity: 0.6;"
                      ) Hoat dong
                    else
                      a(
                        href="javascript:;" 
                        class="badge badge-danger"
                        data-status=item.status
                        data-id=item.id
                        button-change-status=role.permissions.includes("accounts_edit") ? "" : null
                        disable=role.permissions.includes("accounts_edit") ? null : ""
                        style=role.permissions.includes("accounts_edit") ? "" : "pointer-events: none; opacity: 0.6;"
                      ) Dung hoat dong 
                  td 
                    if(role.permissions.includes("accounts_view"))
                      a(
                        class="btn btn-secondary btn-sm"
                        href=`${prefixAdmin}/accounts/detail/${item.id}`
                      ) Chi tiet
                    if(role.permissions.includes("accounts_edit"))
                      a(
                        class="btn btn-warning btn-sm ml-1"
                        href=`${prefixAdmin}/accounts/edit/${item.id}`
                      ) Sua
                    if(role.permissions.includes("accounts_delete"))
                      a(
                        class="btn btn-danger btn-sm ml-1"
                        button-delete
                        data-id=item.id 
                      ) Xoa

  form(
    action=""
    method="POST"
    id="form-change-status"
    data-path=`${prefixAdmin}/accounts/change-status`
  )

  form(
    action=""
    method="POST"
    id="form-delete-item"
    data-path=`${prefixAdmin}/accounts/delete`
  )

  script(src="/admin/js/account.js")
  